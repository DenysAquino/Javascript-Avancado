{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","constructor","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_ordemAtual","_service","NegociacaoService","_init","lista","then","negociacoes","forEach","negociacao","adiciona","catch","erro","console","log","texto","error","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","text","_limpaFormulario","importa","apaga","esvazia","Negociacao","DateHelper","textoParaData","value","parseInt","parseFloat","focus"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController {\n\n    constructor() {\n\n        let $ = document.querySelector.bind(document);\n\n        this._inputData = $('#data');\n        this._inputQuantidade = $('#quantidade');\n        this._inputValor = $('#valor');\n\n        this._listaNegociacoes = new Bind(\n            new ListaNegociacoes(),\n            new NegociacoesView($('#negociacoesView')),\n            'adiciona', 'esvazia');\n\n        this._mensagem = new Bind(\n            new Mensagem(), new MensagemView($('#mensagemView')),\n            'texto');\n\n        this._ordemAtual = ''\n\n        this._service = new NegociacaoService\n\n        this._init()\n    }\n\n    _init() {\n\n\n        this._service\n            .lista()\n            .then(negociacoes =>\n                negociacoes.forEach(negociacao =>\n                    this._listaNegociacoes.adiciona(negociacao)\n                ))\n            .catch(erro => {\n                console.log(erro)\n                this._mensagem.texto = error\n            })\n\n        setInterval(() => {\n            this.importaNegociacoes()\n        }, 3000)\n    }\n\n    adiciona(event) {\n\n        event.preventDefault()\n\n        let negociacao = this._criaNegociacao()\n\n        this._service\n            .cadastra(negociacao)\n            .then(mensagem => {\n                this._listaNegociacoes.adiciona(negociacao)\n                this._mensagem.text = mensagem\n                this._limpaFormulario()\n            })\n            .catch(erro => this._mensagem.texto = erro)\n    }\n\n    importaNegociacoes() {\n\n        this._service\n            .importa(this._listaNegociacoes.negociacoes)\n            .then(negociacoes => negociacoes.forEach(negociacao => {\n                this._listaNegociacoes.adiciona(negociacao);\n                this._mensagem.texto = 'Negociações do período importadas'\n            }))\n            .catch(erro => this._mensagem.texto = erro);\n    }\n\n    apaga() {\n\n        this._service\n            .apaga()\n            .then(mensagem => {\n                this._mensagem.texto = mensagem\n                this._listaNegociacoes.esvazia()\n            })\n            .catch(erro => this._mensagem.texto = erro)\n        \n    }\n\n    _criaNegociacao() {\n\n        return new Negociacao(\n            DateHelper.textoParaData(this._inputData.value),\n            parseInt(this._inputQuantidade.value),\n            parseFloat(this._inputValor.value));\n    }\n\n    _limpaFormulario() {\n\n        this._inputData.value = '';\n        this._inputQuantidade.value = 1;\n        this._inputValor.value = 0.0;\n        this._inputData.focus();\n    }\n}"]}
